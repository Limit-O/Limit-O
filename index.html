<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Limit-O</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        #content {
            white-space: pre-line;
            margin-top: 20px;
        }
        .chapter-list {
            margin-bottom: 20px;
        }
        .chapter-link {
            display: block;
            margin: 5px 0;
            color: #0366d6;
            text-decoration: none;
        }
        .chapter-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>坚守</h1>
    
    <div class="chapter-list" id="chapterList">
        <h2>章节列表</h2>
        <!-- 章节列表将通过JavaScript动态生成 -->
    </div>
    
    <div id="content">
        <p>请从左侧选择章节阅读。</p>
    </div>

    <script>
        // 你的GitHub仓库信息
        const repoOwner = 'Limit-O';
        const repoName = 'Limit-O';
        const folderPath = 'novels'; // 存放小说的文件夹路径
        
        // 获取章节列表
        async function fetchChapters() {
            try {
                const response = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folderPath}`);
                if (!response.ok) {
                    throw new Error('获取章节列表失败');
                }
                const files = await response.json();
                
                const chapterList = document.getElementById('chapterList');
                
                // 过滤出.md文件并创建链接
                files.forEach(file => {
                    if (file.name.endsWith('.md')) {
                        const link = document.createElement('a');
                        link.href = '#';
                        link.className = 'chapter-link';
                        link.textContent = file.name.replace('.txt', '');
                        link.onclick = () => loadChapter(file.path);
                        chapterList.appendChild(link);
                    }
                });
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('content').innerHTML = `<p>加载章节列表时出错: ${error.message}</p>`;
            }
        }
        
        // 加载章节内容
        async function loadChapter(filePath) {
            try {
                const response = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`);
                if (!response.ok) {
                    throw new Error('获取章节内容失败');
                }
                const file = await response.json();
                
                // Base64解码内容
                const content = atob(file.content);
                document.getElementById('content').innerHTML = `<h2>${file.name.replace('.txt', '')}</h2><pre>${content}</pre>`;
                
                // 滚动到内容区域
                document.getElementById('content').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('content').innerHTML = `<p>加载章节内容时出错: ${error.message}</p>`;
            }
        }
        
        // 页面加载时获取章节列表
        window.onload = fetchChapters;
    </script>
</body>
</html>
